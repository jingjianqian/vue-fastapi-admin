# vue-fastapi-admin — Warp Project Guide

A full-stack admin starter combining FastAPI (Python 3.11) and Vue 3 + Vite + Naive UI. Includes RBAC, dynamic routes, and JWT auth. This guide summarizes how to run, build, lint, and develop the project quickly in Warp.

## Stack
- Backend: FastAPI, Tortoise ORM (SQLite by default), Aerich (migrations), Uvicorn
- Frontend: Vue 3, Vite, Pinia, Vue Router, Naive UI, UnoCSS, Axios
- Package managers: pnpm (recommended) or npm
- Docker: Multi-stage build producing an Nginx + Python image exposing port 80

## Repository layout
- Backend (Python): project root
  - Entrypoint: `run.py` (Uvicorn, port 9999, reload on dev)
  - App module: `app/` (routers, models, schemas, settings, init)
  - Config: `app/settings/config.py` (SQLite default DB at `db.sqlite3`)
  - Tooling: `pyproject.toml`, `requirements.txt`, `Makefile`
- Frontend (Vue): `web/`
  - Entry: `web/src/main.js`
  - Router: `web/src/router/index.js`
  - Store: `web/src/store/index.js`
  - API calls: `web/src/api/index.js`
  - Vite config: `web/vite.config.js`
  - Env files: `web/.env`, `.env.development`, `.env.production`

## Prerequisites
- Python 3.11+
- Node.js 18.8.0+
- pnpm (recommended): `npm i -g pnpm`

## Quick start
### Backend (dev)
Option A: uv
1) Create venv: `uv venv` and activate it
2) Install deps: `uv add pyproject.toml`
3) Run: `python run.py` (serves http://localhost:9999, OpenAPI at /docs)

Option B: pip
1) Create venv and activate
2) `pip install -r requirements.txt`
3) `python run.py`

Notes
- First run initializes DB, seeds superuser `admin`/`123456`, menus, roles, and APIs.
- Default DB: SQLite file at `db.sqlite3`; adjust `TORTOISE_ORM` in `app/settings/config.py` to switch to MySQL/Postgres.

### Frontend (dev)
1) `cd web`
2) `pnpm i` (or `npm i`)
3) `pnpm dev`

Defaults
- Dev server port: from `web/.env` (`VITE_PORT=3100`)
- API base: `VITE_BASE_API=/api/v1`
- Proxy: enabled in development (`VITE_USE_PROXY=true`) to backend

## Build
### Frontend
- From `web/`: `pnpm build` (outputs to `web/dist`, controlled by `OUTPUT_DIR` in build/constant)

### Docker (full stack)
- Build: `docker build --no-cache . -t vue-fastapi-admin`
- Run: `docker run -d --restart=always --name=vue-fastapi-admin -p 9999:80 vue-fastapi-admin`
- Access: http://localhost:9999 (Nginx serves frontend; backend proxied)

## Lint, format, test
### Backend (Makefile targets)
- Install deps: `make install` (uv)
- Start: `make start` (equiv. `python run.py`)
- Check: `make check` (black/isort check + ruff)
- Format: `make format` (black + isort)
- Lint: `make lint` (ruff)
- Test: `make test` (pytest)
- DB utils: `make clean-db`, `make migrate`, `make upgrade`

### Frontend
- Lint: `pnpm lint`
- Fix: `pnpm run lint:fix`
- Prettier: `pnpm run prettier`

## Configuration
### Frontend env (web/.env*)
- `.env`:
  - `VITE_TITLE` — app title
  - `VITE_PORT` — dev server port (default 3100)
- `.env.development`:
  - `VITE_PUBLIC_PATH=/`
  - `VITE_USE_PROXY=true`
  - `VITE_BASE_API=/api/v1`
- `.env.production`:
  - `VITE_PUBLIC_PATH=/`
  - `VITE_BASE_API=/api/v1`
  - `VITE_USE_COMPRESS=true`
  - `VITE_COMPRESS_TYPE=gzip`

### Backend settings (app/settings/config.py)
- CORS: allow all by default
- JWT: HS256; default token lifetime 7 days (dev defaults only)
- DB: SQLite; switch to MySQL/Postgres by uncommenting and configuring in `TORTOISE_ORM`

## Routing and auth
- Backend mounts routers under `/api` and versioned as `/api/v1`.
- Frontend API module calls endpoints under `/base`, `/user`, `/role`, `/menu`, `/api`, `/dept`, `/auditlog` with base `/api/v1`.
- Auth: JWT; login via `/api/v1/base/access_token`.

## Common tasks
- Change dev server port: edit `web/.env` → `VITE_PORT`
- Change API base path: edit `web/.env.*` → `VITE_BASE_API`
- Update DB engine: edit `app/settings/config.py` → `TORTOISE_ORM`
- Reset local DB: `make clean-db` (removes migrations and sqlite files), then rerun

## Tips for Warp
- Primary dev commands:
  - Backend: `python run.py`
  - Frontend: `cd web && pnpm dev`
- Open API docs: http://localhost:9999/docs
- Default admin for seeded data: `admin` / `123456` (change in production)

---
Generated by Agent Mode to speed up onboarding and command discovery.
